<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Pump Pressure â€” Visual Builder</title>
  <link rel="stylesheet" href="pump-style.css" />
  <meta name="theme-color" content="#0b0f14" />
</head>
<body>
  <div class="app">

    <!-- Branded Header -->
    <header class="brandbar">
      <div class="brand-left">
        <div class="brand-logo" aria-hidden="true">ðŸ”¥</div>
        <div class="brand-text">
          <div class="brand-title">FireOps SIM</div>
          <div class="brand-sub">Pump Pressure â€” Visual Builder</div>
        </div>
      </div>
      <nav class="brand-right">
        <a class="brand-link" href="/" aria-label="Home">Home</a>
        <a class="brand-link" href="/visual-pump" aria-label="Visual Pump Calculator">Visual Pump</a>
      </nav>
    </header>

    <!-- Floating action buttons (unchanged behavior) -->
    <div class="side">
      <button class="fab" id="openHose" title="Hose">H</button>
      <button class="fab" id="openAcc" title="Accessories">A</button>
      <button class="fab" id="openNoz" title="Nozzles">N</button>
    </div>

    <!-- Left Drawer -->
    <aside class="drawer" id="drawer" aria-hidden="true">
      <h3 id="drawerTitle">Hose</h3>

      <!-- Main hose section -->
      <div class="row" id="hoseButtonsMain">
        <button data-hose='{"size":"5","lengthFt":100}'>5â€³ 100â€²</button>
        <button data-hose='{"size":"2.5","lengthFt":50}'>2Â½â€³ 50â€²</button>
        <button data-hose='{"size":"1.75","lengthFt":100}'>1Â¾â€³ 100â€²</button>
        <button data-hose='{"size":"1.75","lengthFt":50}'>1Â¾â€³ 50â€²</button>
        <button data-act="clearHose">Clear main hoses</button>
      </div>

      <!-- After-wye branches -->
      <div class="row" id="hoseButtonsSplit" style="display:none;border-top:1px solid var(--edge);margin-top:6px;padding-top:12px">
        <div class="drawer-note">After Wye:</div>
        <button data-side="L" data-hose='{"size":"2.5","lengthFt":50}'>Left 2Â½â€³ 50â€²</button>
        <button data-side="L" data-hose='{"size":"1.75","lengthFt":100}'>Left 1Â¾â€³ 100â€²</button>
        <button data-side="L" data-hose='{"size":"1.75","lengthFt":50}'>Left 1Â¾â€³ 50â€²</button>
        <button data-side="R" data-hose='{"size":"2.5","lengthFt":50}'>Right 2Â½â€³ 50â€²</button>
        <button data-side="R" data-hose='{"size":"1.75","lengthFt":100}'>Right 1Â¾â€³ 100â€²</button>
        <button data-side="R" data-hose='{"size":"1.75","lengthFt":50}'>Right 1Â¾â€³ 50â€²</button>
        <button data-act="clearSplit">Clear after-wye</button>
      </div>

      <!-- Accessories -->
      <div class="row" id="accButtons" style="display:none">
        <button data-acc='{"name":"Wye","loss":10}'>Add Wye</button>
        <button data-acc='{"name":"Appliance","loss":10}'>+10 Appliance</button>
        <button data-acc='{"name":"Master Stream","loss":25}'>+25 Master</button>
        <button data-acc='{"name":"Siamesed","loss":10}'>+10 Siamese</button>
        <button data-act="clearAcc">Clear accessories</button>
      </div>

      <!-- Nozzles -->
      <div class="row" id="nozButtons" style="display:none">
        <div class="row" id="nozRowLeft"><h3>Left Branch Nozzle</h3></div>
        <div class="row" id="nozRowRight" style="border-top:1px solid var(--edge);padding-top:10px"><h3>Right/Single Nozzle</h3></div>
      </div>
    </aside>

    <!-- Stage -->
    <div class="wrapper">
      <div id="scroll" class="scroll">
        <div id="stage" class="stage">
          <!-- Branded engine image kept -->
          <img id="engine" alt="ENGINE 181" src="https://fireopssim.com/pump/engine181.png" />

          <svg id="overlay" viewBox="0 0 390 800" preserveAspectRatio="none" aria-label="Diagram overlay">
            <defs>
              <marker id="arrow" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
                <path d="M0,0 L6,3 L0,6 z" fill="#cfe4ff"></path>
              </marker>
            </defs>
            <g id="hoses"></g>
            <g id="branches"></g>
            <text id="hint" x="12" y="24" class="hint">Tap Line 1/2/3 to deployâ€¦</text>
          </svg>

          <!-- Selected line info -->
          <div id="lineinfo" class="lineinfo"></div>

          <!-- Line buttons under truck (all deployable/togglable) -->
          <div class="linebar" id="linebar">
            <button class="linebtn" data-line="left">Line 1</button>
            <button class="linebtn" data-line="right">Line 2</button>
            <button class="linebtn" data-line="back">Line 3</button>
          </div>

          <!-- (Optional) discharge picker; kept for future use -->
          <div id="dischargePicker" class="picker" role="dialog" aria-modal="true" aria-hidden="true">
            <h3 id="dischTitle">Select Discharge</h3>
            <div class="row" id="dischRow"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- KPI Panel -->
    <section class="panel">
      <div class="card">
        <div class="grid2">
          <div>
            <label>Elevation (ft)</label>
            <input id="elevFt" type="number" min="-300" max="300" value="0" />
          </div>
          <div>
            <label>Elevation PSI/ft</label>
            <input id="elevPsiPerFt" type="number" step="0.001" value="0.434" />
          </div>
        </div>

        <div class="kpis">
          <div class="kpi"><div>Total FL (Main)</div><b id="FLmain">â€” psi</b></div>
          <div class="kpi"><div>Left FL</div><b id="FLleft">â€” psi</b></div>
          <div class="kpi"><div>Right FL</div><b id="FLright">â€” psi</b></div>
          <div class="kpi"><div>Accessories</div><b id="ACC">â€” psi</b></div>
          <div class="kpi"><div>Nozzle</div><b id="NP">â€” psi</b></div>
        </div>

        <div class="eq" id="equation">PDP = max(Left, Right) + Main FL + Acc Â± Elev</div>
        <div class="kpis" style="margin-top:8px">
          <div class="kpi"><div>Flow</div><b id="GPM">â€” gpm</b></div>
          <div class="kpi"><div>PDP</div><b id="PDP">â€” psi</b></div>
        </div>
        <div class="note" id="breakdown" style="margin-top:8px"></div>
      </div>
    </section>

    <!-- Branded Footer -->
    <footer class="brandfoot">
      <div class="foot-wrap">
        <div class="foot-badge">Part of the <a href="https://emscodesim.com" target="_blank" rel="noopener">EMSCodeSim</a> ecosystem.</div>
        <div class="foot-links">
          <a href="https://fireopssim.com" target="_blank" rel="noopener">FireOps SIM</a>
          <span>â€¢</span>
          <a href="https://dailyemsquiz.com" target="_blank" rel="noopener">DailyEMSQuiz</a>
        </div>
      </div>
    </footer>

  </div>

  <script src="pump-logic.js"></script>
</body>
</html>
