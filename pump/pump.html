<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Pump Pressure ‚Äî Visual Builder</title>
<link rel="stylesheet" href="pump-style.css" />
</head>
<body>
<div class="app">

  <header>
    <h1>Pump Pressure ‚Äî Visual Builder</h1>
    <div class="sub">Tap a line to deploy it ‚Ä¢ ‚Äú+‚Äù at tip to edit</div>
  </header>

  <div class="side">
    <button class="fab" id="openHose">Hose</button>
    <button class="fab" id="openAcc">Acc</button>
    <button class="fab" id="openNoz">Noz</button>
  </div>

  <!-- Hose drawer -->
  <div class="drawer" id="drawerHose" role="dialog" aria-label="Hose options">
    <h3>Hose segments</h3>
    <div class="row" id="hoseButtonsMain">
      <button data-hose='{"size":"5","lengthFt":100}'>5‚Ä≥ 100‚Ä≤</button>
      <button data-hose='{"size":"2.5","lengthFt":50}'>2¬Ω‚Ä≥ 50‚Ä≤</button>
      <button data-hose='{"size":"1.75","lengthFt":100}'>1¬æ‚Ä≥ 100‚Ä≤</button>
      <button data-hose='{"size":"1.75","lengthFt":50}'>1¬æ‚Ä≥ 50‚Ä≤</button>
      <button data-act="clearHose">Clear main hoses</button>
    </div>

    <div class="row" id="hoseButtonsSplit" style="display:none;border-top:1px solid var(--edge);margin-top:6px;padding-top:12px">
      <div style="width:100%;color:#cfe4ff;font-size:12px;margin-bottom:2px">After Wye:</div>
      <button data-side="L" data-hose='{"size":"2.5","lengthFt":50}'>Left 2¬Ω‚Ä≥ 50‚Ä≤</button>
      <button data-side="L" data-hose='{"size":"1.75","lengthFt":100}'>Left 1¬æ‚Ä≥ 100‚Ä≤</button>
      <button data-side="L" data-hose='{"size":"1.75","lengthFt":50}'>Left 1¬æ‚Ä≥ 50‚Ä≤</button>
      <button data-side="R" data-hose='{"size":"2.5","lengthFt":50}'>Right 2¬Ω‚Ä≥ 50‚Ä≤</button>
      <button data-side="R" data-hose='{"size":"1.75","lengthFt":100}'>Right 1¬æ‚Ä≥ 100‚Ä≤</button>
      <button data-side="R" data-hose='{"size":"1.75","lengthFt":50}'>Right 1¬æ‚Ä≥ 50‚Ä≤</button>
      <button data-act="clearBranches">Clear left/right</button>
    </div>
  </div>

  <!-- Accessory drawer -->
  <div class="drawer" id="drawerAcc" role="dialog" aria-label="Accessory options">
    <h3>Accessories</h3>
    <div class="row">
      <button data-acc='{"name":"In-line eductor","loss":25}'>In-line eductor (+25)</button>
      <button data-acc='{"name":"Master monitor","loss":25}'>Master monitor (+25)</button>
      <button data-acc='{"name":"Standpipe/PRV","loss":25}'>Standpipe/PRV (+25)</button>
      <button data-act="accCustom">Custom‚Ä¶</button>
      <button data-act="clearAcc">Clear accessories</button>
    </div>
    <h3 style="margin-top:4px">Split</h3>
    <div class="row">
      <button id="addWyeBtn">Wye/Siamese (split) +10 psi</button>
      <button id="removeWyeBtn">Remove Wye</button>
    </div>
  </div>

  <!-- Nozzle drawer -->
  <div class="drawer" id="drawerNoz" role="dialog" aria-label="Nozzle options">
    <h3>Left Nozzle</h3>
    <div class="row" id="nozRowLeft"></div>
    <h3>Right / Single Nozzle</h3>
    <div class="row" id="nozRowRight"></div>
  </div>

  <!-- Stage -->
  <div class="wrapper">
    <div id="scroll" class="scroll">
      <div id="stage" class="stage">
        <img id="engine" alt="ENGINE 181" src="https://fireopssim.com/pump/engine181.png" />
        <svg id="overlay" viewBox="0 0 390 800" preserveAspectRatio="none" aria-label="Diagram overlay">
          <defs>
            <filter id="hoseGlowT" x="-50%" y="-50%" width="200%" height="200%">
              <feGaussianBlur stdDeviation="3" result="blur"/>
              <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
            </filter>
            <clipPath id="roofClip">
              <rect id="roofClipRect" x="0" y="0" width="390" height="0"></rect>
            </clipPath>
          </defs>

          <g id="hoseGroup"></g>
          <g id="accGroup"></g>
          <g id="nozzleGroup"></g>
          <g id="portGroup"></g>
          <g id="labelGroup"></g>

          <!-- Discharge (visual) -->
          <g id="dischargeGroup" clip-path="url(#roofClip)"></g>
          <g id="dischargeLabels"></g>

          <text class="hint" id="hint">Tap Line 1/2/3 to deploy‚Ä¶</text>
        </svg>

        <!-- Top info for selected line -->
        <div id="lineinfo" class="lineinfo"></div>

        <!-- Line selector under the truck -->
        <div class="linebar" id="linebar">
          <button class="linebtn" data-line="left">Line 1</button>
          <button class="linebtn" data-line="right">Line 2</button>
          <button class="linebtn" data-line="back">Line 3</button>
        </div>

        <!-- Discharge picker -->
        <div id="dischargePicker" class="picker" role="dialog" aria-modal="true" aria-hidden="true">
          <h3 id="pickerTitle">Line</h3>

          <div id="pickerHome">
            <div class="section-title">Choose an action</div>
            <div class="picker-grid">
              <div class="pick" data-view="addhose">‚ûï Add Hose</div>
              <div class="pick" data-view="nozzle">üß© Nozzle</div>
              <div class="pick" data-view="accessory">‚öôÔ∏è Accessory</div>
              <div class="pick" data-view="config">üõ†Ô∏è Change Config</div>
            </div>
          </div>

          <div id="pickerAddHose" style="display:none">
            <div class="section-title">Add hose length</div>
            <div class="picker-actions">
              <button class="pick-small" data-addlen="50" data-size="1.75">+50‚Ä≤ 1¬æ‚Ä≥</button>
              <button class="pick-small" data-addlen="50" data-size="2.5">+50‚Ä≤ 2¬Ω‚Ä≥</button>
            </div>
            <div class="picker-actions"><button class="pick-small" data-back>‚¨Ö Back</button></div>
          </div>

          <div id="pickerNozzle" style="display:none">
            <div class="section-title">Set nozzle</div>
            <div class="picker-grid">
              <div class="pick" data-type="nozzle" data-id="smoothbore">Smooth Bore (SB)</div>
              <div class="pick" data-type="nozzle" data-id="fog50">Fog Nozzle 50 PSI</div>
              <div class="pick" data-type="nozzle" data-id="chief185">ChiefXD 185 @50</div>
              <div class="pick" data-type="nozzle" data-id="chief265">ChiefXD 265 @50</div>
            </div>
            <div class="picker-actions"><button class="pick-small" data-back>‚¨Ö Back</button></div>
          </div>

          <div id="pickerAcc" style="display:none">
            <div class="section-title">Attach accessory</div>
            <div class="picker-grid">
              <div class="pick" data-type="accessory" data-id="wye">Wye</div>
              <div class="pick" data-type="accessory" data-id="gated_wye">Gated Wye</div>
              <div class="pick" data-type="accessory" data-id="siamese">Siamese</div>
              <div class="pick" data-type="accessory" data-id="standpipe">Standpipe</div>
              <div class="pick" data-type="accessory" data-id="flowmeter">Inline Flowmeter</div>
              <div class="pick" data-type="accessory" data-id="cap">Cap</div>
            </div>
            <div class="picker-actions"><button class="pick-small" data-back>‚¨Ö Back</button></div>
          </div>

          <div id="pickerConfig" style="display:none">
            <div class="section-title">Size</div>
            <div class="picker-actions">
              <button class="pick-small" data-size-set="1.75">1¬æ‚Ä≥</button>
              <button class="pick-small" data-size-set="2.5">2¬Ω‚Ä≥</button>
            </div>
            <div class="section-title">Total Length</div>
            <div class="picker-actions">
              <button class="pick-small" data-len-set="50">50‚Ä≤</button>
              <button class="pick-small" data-len-set="100">100‚Ä≤</button>
              <button class="pick-small" data-len-set="150">150‚Ä≤</button>
              <button class="pick-small" data-len-set="200">200‚Ä≤</button>
              <button class="pick-small" data-len-set="250">250‚Ä≤</button>
              <button class="pick-small" data-len-set="300">300‚Ä≤</button>
            </div>
            <div class="section-title">Quick</div>
            <div class="picker-actions">
              <button class="pick-small" data-reset-default>Reset to defaults</button>
              <button class="pick-small" data-back>‚¨Ö Back</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Panels -->
  <div class="panel">
    <div class="card">
      <h3 style="margin:0 0 8px;font-size:14px;color:#cfe4ff">Environment</h3>
      <div class="grid2">
        <div><label>Elevation (ft)</label><input id="elevFt" type="number" step="5" value="0" /></div>
        <div><label>Elevation factor (psi/ft)</label><input id="elevPsi" type="number" step="0.001" value="0.434" /></div>
      </div>
    </div>

    <div class="card">
      <h3 style="margin:0 0 8px;font-size:14px;color:#cfe4ff">Build List</h3>
      <div class="list" id="builderList"></div>
    </div>

    <div class="card">
      <div class="eq" id="equation">PDP = max(Left, Right) + Main FL + Main Acc ¬± Elev</div>
      <div class="kpis" style="margin-top:8px">
        <div class="kpi"><div>Flow</div><b id="GPM">‚Äî gpm</b></div>
        <div class="kpi"><div>PDP</div><b id="PDP">‚Äî psi</b></div>
      </div>
      <div class="note" id="breakdown" style="margin-top:8px"></div>
    </div>
  </div>

</div>

<script src="pump-logic.js"></script>
</body>
</html>
